<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI ìŠ¤íƒ€ì¼ ì§„ë‹¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .intro {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .intro h2 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .intro ul {
            margin-left: 20px;
            line-height: 1.8;
        }

        .name-input-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .name-input-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            text-align: center;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
            margin: 0 auto;
        }

        .input-group label {
            font-weight: bold;
            color: #495057;
        }

        .input-group input {
            padding: 15px;
            font-size: 1.1em;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .user-name-display {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .user-name-display strong {
            color: #667eea;
            font-size: 1.3em;
        }

        .result-copy-box {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .submit-info {
            background: #d1ecf1;
            border: 2px solid #17a2b8;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .submit-info h4 {
            color: #17a2b8;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .question-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .question-number {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 0.9em;
        }

        .option {
            padding: 25px;
            background: white;
            border-radius: 15px;
            border: 3px solid #e9ecef;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.05em;
            line-height: 1.6;
        }

        .option:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.2);
        }

        .option.selected {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-color: #667eea;
            border-width: 4px;
        }

        .option-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .option-label {
            font-weight: bold;
            color: #667eea;
            font-size: 1.5em;
            min-width: 40px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid #667eea;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
        }

        .option.selected .option-label {
            background: #667eea;
            color: white;
        }

        .option-text {
            flex: 1;
            font-weight: 500;
        }

        .check-icon {
            font-size: 1.5em;
            color: #667eea;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .option.selected .check-icon {
            opacity: 1;
        }

        .navigation-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }

        .navigation-buttons button {
            flex: 1;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
        }

        .progress-bar {
            background: #e9ecef;
            height: 8px;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #6c757d;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.1em;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: bold;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .button-container {
            text-align: center;
            margin-top: 30px;
        }

        .result {
            padding: 30px;
            text-align: center;
        }

        .result h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .mbti-result {
            font-size: 4em;
            font-weight: bold;
            color: #764ba2;
            margin: 30px 0;
            letter-spacing: 10px;
        }

        .category-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .category-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .category-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .category-score {
            font-size: 2em;
            font-weight: bold;
            color: #764ba2;
            margin: 10px 0;
        }

        .balance-info {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .balance-info.strong {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .balance-info.very-strong {
            background: #d1ecf1;
            border-color: #17a2b8;
        }

        .description-box {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            text-align: left;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .description-box h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .description-box p {
            line-height: 1.8;
            color: #495057;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .mbti-result {
                font-size: 2.5em;
                letter-spacing: 5px;
            }

            .category-results {
                grid-template-columns: 1fr;
            }

            .option {
                padding: 20px;
            }

            .option-label {
                width: 35px;
                height: 35px;
                font-size: 1.3em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§  MBTI ìŠ¤íƒ€ì¼ ì§„ë‹¨</h1>
            <p>ë‚˜ì˜ ì„±ê²© ìœ í˜•ì„ ì•Œì•„ë³´ì„¸ìš”</p>
        </div>

        <div id="app"></div>
    </div>

    <script>
        // âš™ï¸ ê´€ë¦¬ì ì„¤ì • - êµ¬ê¸€ ì‹œíŠ¸ ì—°ë™
        // ì•„ë˜ URLì„ êµ¬ê¸€ Apps Script ì›¹ ì•± URLë¡œ êµì²´í•˜ì„¸ìš”
        const GOOGLE_SHEET_URL = "https://script.google.com/macros/s/AKfycbyCJi2bcOZ00war6LQzJf_ky4TwzkQogE1FFozBBOx2pAUfFlowV4KNoBeTeKJb8zEd/exec";
        
        const questions = [
            { q: 1, a: "ë‹¤ë¥¸ ì‚¬ëŒì´ ì–´ë–»ê²Œ ìƒê°í•˜ëŠ”ê°€ë¥¼ ì•Œì•„ ë³¸ í›„ì— ê²°ì •ì„ ë‚´ë¦°ë‹¤.", b: "ë‹¤ë¥¸ ì‚¬ëŒê³¼ ìƒì˜í•˜ì§€ ì•Šê³  ê²°ì •ì„ ë‚´ë¦°ë‹¤." },
            { q: 2, a: "ìƒìƒë ¥ì´ í’ë¶€í•˜ê±°ë‚˜ ì§ê°ì ì´ë¼ëŠ” ë§ì„ ë“£ëŠ” í¸ì´ë‹¤.", b: "ì‚¬ì‹¤ì ì´ê³  ì •í™•í•˜ë‹¤ëŠ” ë§ì„ ë“£ëŠ” í¸ì´ë‹¤." },
            { q: 3, a: "ìŠµë“ ê°€ëŠ¥í•œ ìë£Œì™€ ìƒí™©ì— ëŒ€í•œ ì²´ê³„ì  ë¶„ì„ì„ ê·¼ê±°ë¡œ í‰ê°€í•œë‹¤.", b: "ë™ì •ì´ë‚˜ ê°ì • í˜¹ì€ ê·¸ë“¤ì˜ í•„ìš”ì™€ ê°€ì¹˜ê´€ì— ê·¼ê±°ë¥¼ ë‘ê³  ì‚¬ëŒì„ í‰ê°€í•œë‹¤." },
            { q: 4, a: "ë‹¤ë¥¸ ì‚¬ëŒì´ ì›í•˜ëŠ” ëŒ€ë¡œ ì•½ì†ì„ í•˜ë„ë¡ ë‚´ë²„ë ¤ ë‘ëŠ” í¸ì´ë‹¤.", b: "ë‚˜ì˜ ì˜ê²¬ì´ ëª…í™•í•˜ê²Œ ë“œëŸ¬ë‚˜ë„ë¡ í™•ì‹¤í•œ ì•½ì†ì„ ì¶”ì§„í•œë‹¤." },
            { q: 5, a: "ì¡°ìš©í•˜ê³  í˜¼ì ì‚¬ìƒ‰ì— ì ê¸°ê¸°ë¥¼ ì¦ê¸´ë‹¤.", b: "ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í™œë™ì ì´ê³  ì •ë ¥ì ìœ¼ë¡œ ì‹œê°„ ë³´ë‚´ê¸°ë¥¼ ì¦ê¸´ë‹¤." },
            { q: 6, a: "ì¼ì„ í•´ê²°í•˜ëŠ”ë° íš¨ê³¼ê°€ ìˆì—ˆë˜ ë°©ì‹ì„ ì±„íƒí•œë‹¤.", b: "ì¼ì´ ë‹¥ì³¤ì„ ë•Œ ìƒˆë¡œìš´ í•´ê²°ì±…ì„ ìƒê°í•´ ë³´ë ¤ í•œë‹¤." },
            { q: 7, a: "ê°ì • ê°œì…ì´ ì—†ëŠ” ë…¼ë¦¬ì  ì¶”ë¦¬ì™€ ë‹¨ê³„ì ì¸ ë¶„ì„ì„ í† ëŒ€ë¡œ ê²°ë¡ ì„ ì§“ëŠ”ë‹¤.", b: "ê²½í—˜, ì¸ìƒ, ì‚¬ëŒë“¤ì— ëŒ€í•´ ë‚´ê°€ ëŠë¼ê±°ë‚˜ ë¯¿ëŠ” ë°”ì— ì˜í•´ ê²°ë¡ ì„ ë‚´ë¦°ë‹¤." },
            { q: 8, a: "ì‹œí•œì„ ì •í•´ ë‘ëŠ” ê²ƒì„ ì‹«ì–´í•œë‹¤.", b: "ê³„íšì„ ì„¸ìš°ë©´ ê·¸ê²ƒì— ì§‘ì°©í•˜ëŠ” í¸ì´ë‹¤." },
            { q: 9, a: "ì ì‹œ ëŒ€í™”í•˜ë‹¤ê°€ëŠ” ì´ë‚´ ì£¼ì œì— ëŒ€í•´ í˜¼ì ìƒê°í•œë‹¤.", b: "í•œì°¸ ë™ì•ˆ ììœ ë¡­ê²Œ ì´ì•¼ê¸°í•˜ê³  ë‚˜ì„œ ë‚˜ì¤‘ì— í˜¼ì ìƒê°í•œë‹¤." },
            { q: 10, a: "ê°€ëŠ¥ì„±ì„ ìƒê°í•œë‹¤.", b: "í˜„ì‹¤ì ì¸ ê²ƒì„ ë‹¤ë£¬ë‹¤." },
            { q: 11, a: "ë‚¨ë“¤ì€ ë‚˜ë¥¼ ìƒê°ì´ ê¹Šì€ ì‚¬ëŒìœ¼ë¡œ ì—¬ê¸´ë‹¤.", b: "ë‚¨ë“¤ì€ ë‚˜ë¥¼ ê°ì •ì´ í’ë¶€í•œ ì‚¬ëŒìœ¼ë¡œ ì—¬ê¸´ë‹¤." },
            { q: 12, a: "ê²°ì •ì„ ë‚´ë¦¬ê¸° ì „ì´ë‚˜ í›„ì— ì˜¤ëœ ì‹œê°„ ëª¨ë“  ê°€ëŠ¥í•œ ê°ë„ë¥¼ ê³ ë ¤í•´ë³¸ë‹¤.", b: "í•„ìš”í•œ ì •ë³´ë¥¼ ì–»ìœ¼ë©´ ì ì‹œ ìƒê°í•œ í›„ì— ì‹ ì†íˆ í™•ê³ í•œ ê²°ì •ì„ ë‚´ë¦°ë‹¤." },
            { q: 13, a: "ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ì•Œ ìˆ˜ ì—†ëŠ” ë‚´ë©´ì ì¸ ìƒê°ì´ë‚˜ ëŠë‚Œì„ í˜¼ì ì¦ê¸´ë‹¤.", b: "ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ í•¨ê»˜ ì°¸ê°€í•˜ëŠ” í™œë™ì´ë‚˜ ì‚¬ê±´ì„ ì¦ê¸´ë‹¤." },
            { q: 14, a: "ì¶”ìƒì ì´ë‚˜ ì´ë¡ ì ì¸ ê²ƒì„ ì¢‹ì•„í•œë‹¤.", b: "êµ¬ì²´ì ì´ê±°ë‚˜ ì‹¤ì§ˆì ì¸ ê²ƒì„ ì¢‹ì•„í•œë‹¤." },
            { q: 15, a: "ë‹¤ë¥¸ ì‚¬ëŒë“¤ë¡œ í•˜ì—¬ê¸ˆ ìê¸°ë“¤ì˜ ê°ì •ì„ íƒìƒ‰í•˜ë„ë¡ ë„ì™€ì¤€ë‹¤.", b: "ë‹¤ë¥¸ ì‚¬ëŒë“¤ë¡œ í•˜ì—¬ê¸ˆ ë…¼ë¦¬ì ì¸ íŒë‹¨ì„ í•˜ë„ë¡ ë„ì™€ì¤€ë‹¤." },
            { q: 16, a: "ë³€í™”ë¥¼ ì¢‹ì•„í•˜ê³  ì„ íƒì˜ ë²”ìœ„ë¥¼ ë„“í˜€ ë†“ëŠ”ë‹¤.", b: "ì˜ˆì¸¡ ê°€ëŠ¥ì„±ì„ ì¢‹ì•„í•˜ê³  ë¯¸ë¦¬ ì•Œì•„ ë§ì¶”ê¸°ë¥¼ ì¢‹ì•„í•œë‹¤." },
            { q: 17, a: "ìì‹ ì˜ ë‚´ë©´ì ì¸ ìƒê°ê³¼ ê°ì •ì„ íƒ€ì¸ì—ê²Œ ê±°ì˜ ì „ë‹¬í•˜ì§€ ì•ŠëŠ”ë‹¤.", b: "ìì‹ ì˜ ë‚´ë©´ì ì¸ ìƒê°ê³¼ ê°ì •ì„ ììœ ë¡­ê²Œ ì „ë‹¬í•œë‹¤." },
            { q: 18, a: "ê°€ê¸‰ì  ì „ì²´ì˜ ê°€ëŠ¥ì„±ì— ê´€í•œ ì˜ê²¬ì„ ì œì¶œí•œë‹¤.", b: "ê°€ê¸‰ì  ì–»ì„ ìˆ˜ ìˆëŠ” ì‹¤ì§ˆì ì¸ ì„¸ë¶€ ì‚¬í•­ì„ ì œì‹œí•œë‹¤." },
            { q: 19, a: "ìƒì‹ê³¼ ì‹ ë…ì„ ê¸°ì´ˆë¡œ ê²°ë¡ ì„ ë‚´ë¦°ë‹¤.", b: "ìë£Œ, ë¶„ì„, ì¶”ë¦¬ë¥¼ ê¸°ì´ˆë¡œ ê²°ë¡ ì„ ë‚´ë¦°ë‹¤." },
            { q: 20, a: "ì „ì²´ ìœ¤ê³½ì— ê¸°ì´ˆë¥¼ ë‘ê³  ë¯¸ë¦¬ ê³„íšì„ ì„¸ìš´ë‹¤.", b: "ìˆ˜í–‰í•˜ê¸° ë°”ë¡œ ì „ì— í•„ìš”ì— ë”°ë¼ ê³„íšì„ ì„¸ìš´ë‹¤." },
            { q: 21, a: "ëª¨ë¥´ëŠ” ì‚¬ëŒì„ ì¦ê²¨ ë§Œë‚œë‹¤.", b: "í˜¼ì ìˆê±°ë‚˜ ì˜ ì•„ëŠ” ì‚¬ëŒê³¼ ìˆê¸°ë¥¼ ì¢‹ì•„í•œë‹¤." },
            { q: 22, a: "êµ¬ìƒí•˜ê³  ê³ ì•ˆí•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤.", b: "ì‹¤ì²´ì ì¸ ì‚¬ì‹¤ì„ êµ¬í•œë‹¤." },
            { q: 23, a: "ì§ê°ì ì¸ í™•ì‹ ê³¼ ì‹ ë…ì„ ê°–ëŠ”ë‹¤.", b: "ì¦ëª…ë  ìˆ˜ ìˆëŠ” ê²°ë¡ ì„ ì–»ëŠ”ë‹¤." },
            { q: 24, a: "ì•½ì† ë‚´ìš©ì´ë‚˜ ì—…ë¬´ ì²˜ë¦¬ ì¼ì •ì„ ë…¸íŠ¸ë‚˜ ìˆ˜ì²©ì— ê°€ëŠ¥í•œ í•œ ë§ì´ ì ëŠ”ë‹¤.", b: "ë…¸íŠ¸ë‚˜ ìˆ˜ì²©ì— ì•½ì†ì— ê´€í•œ ê²ƒì„ ë³„ë¡œ ì ì§€ ì•ŠëŠ”ë‹¤." },
            { q: 25, a: "ì—¬ëŸ¬ ì‚¬ëŒê³¼ í•¨ê»˜ ìƒˆë¡œìš´ ë¬¸ì œì— ëŒ€í•´ ì´ì•¼ê¸°í•˜ê¸°ë¥¼ ì¦ê¸´ë‹¤.", b: "ìš°ì„  ìŠ¤ìŠ¤ë¡œ ë§ˆìŒì†ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•œ í›„ ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ ì´ì•¼ê¸° í•œë‹¤." },
            { q: 26, a: "ì •í™•ì„±ì„ ìš”êµ¬í•˜ëŠ” ì„¸ë°€í•œ ê³„íšì„ ì¡°ì‹¬ì„± ìˆê²Œ ìˆ˜í–‰í•œë‹¤.", b: "ê³„íšê³¼ êµ¬ìƒì„ ì„¸ìš°ê¸´ í•˜ë‚˜ ê·¸ê²ƒì„ ë°˜ë“œì‹œ ì‹¤ì²œí•˜ëŠ” í¸ì€ ì•„ë‹ˆë‹¤." },
            { q: 27, a: "ë…¼ë¦¬ì ì¸ ì‚¬ëŒë“¤ì„ ì¢‹ì•„í•œë‹¤.", b: "ê°ì •ì´ í’ë¶€í•œ ì‚¬ëŒë“¤ì„ ì¢‹ì•„í•œë‹¤." },
            { q: 28, a: "ì¼ì„ ì²˜ë¦¬í•˜ëŠ”ë° ìˆœê°„ì˜ ì¶©ë™ì— ì˜í•´ ì¼ì„ í•˜ê¸°ë„ í•œë‹¤.", b: "ë‚´ê°€ í•´ì•¼ í•  ê²ƒì„ ë¯¸ë¦¬ ì˜ ì•Œê³  ìˆë‹¤." },
            { q: 29, a: "ëª¨ë“  ì‚¬ëŒì˜ ê´€ì‹¬ì˜ ì´ˆì ì´ ë˜ê¸°ë¥¼ ì¦ê¸´ë‹¤.", b: "íƒ€ì¸ì˜ ê´€ì‹¬ì€ ì†ë°•ì²˜ëŸ¼ ëŠê»´ì§„ë‹¤." },
            { q: 30, a: "ì‹¤ì œ í•˜ì§€ ì•Šì€ ê²ƒì„ ìƒìƒí•˜ê¸°ë¥¼ ì¦ê¸´ë‹¤.", b: "ì‹¤ì œì˜ ì‚¬ë¬¼ì„ ìƒì„¸í•˜ê²Œ ê²€í† í•˜ëŠ” ê²ƒì„ ì¦ê¸´ë‹¤." },
            { q: 31, a: "ê°ì •ì´ ë­‰í´í•´ì§€ëŠ” ìƒí™©, ì˜í™” ë“±ì„ ì¢‹ì•„í•œë‹¤.", b: "ìƒí™©ì„ ëƒ‰ì² í•˜ê²Œ ë¶„ì„í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤." },
            { q: 32, a: "ì•½ì†ëœ ì‹œê°„ì— ì •í™•íˆ íšŒì˜ë¥¼ ì‹œì‘í•˜ë ¤ í•œë‹¤.", b: "ëª¨ë‘ê°€ ë¶„ìœ„ê¸°ê°€ ê°–ì¶°ì§„ í›„ì— ë³¸ê²©ì ìœ¼ë¡œ íšŒì˜ë¥¼ ì‹œì‘í•œë‹¤." }
        ];

        const categoryMapping = {
            1: { a: 'E', b: 'I' },
            2: { a: 'N', b: 'S' },
            3: { a: 'T', b: 'F' },
            4: { a: 'P', b: 'J' },
            5: { a: 'I', b: 'E' },
            6: { a: 'S', b: 'N' },
            7: { a: 'T', b: 'F' },
            8: { a: 'P', b: 'J' },
            9: { a: 'I', b: 'E' },
            10: { a: 'N', b: 'S' },
            11: { a: 'T', b: 'F' },
            12: { a: 'P', b: 'J' },
            13: { a: 'I', b: 'E' },
            14: { a: 'N', b: 'S' },
            15: { a: 'F', b: 'T' },
            16: { a: 'P', b: 'J' },
            17: { a: 'I', b: 'E' },
            18: { a: 'N', b: 'S' },
            19: { a: 'F', b: 'T' },
            20: { a: 'J', b: 'P' },
            21: { a: 'E', b: 'I' },
            22: { a: 'N', b: 'S' },
            23: { a: 'F', b: 'T' },
            24: { a: 'J', b: 'P' },
            25: { a: 'E', b: 'I' },
            26: { a: 'S', b: 'N' },
            27: { a: 'T', b: 'F' },
            28: { a: 'P', b: 'J' },
            29: { a: 'E', b: 'I' },
            30: { a: 'N', b: 'S' },
            31: { a: 'F', b: 'T' },
            32: { a: 'J', b: 'P' }
        };

        const mbtiDescriptions = {
            'I': { name: 'ë‚´í–¥í˜• (Introvert)', desc: 'ì¡°ìš©í•˜ê³  ì‹ ì¤‘í•˜ë©°, í˜¼ì ìˆëŠ” ì‹œê°„ì„ í†µí•´ ì—ë„ˆì§€ë¥¼ ì–»ìŠµë‹ˆë‹¤.' },
            'E': { name: 'ì™¸í–¥í˜• (Extrovert)', desc: 'í™œë™ì ì´ê³  ì‚¬êµì ì´ë©°, ì‚¬ëŒë“¤ê³¼ì˜ êµë¥˜ë¥¼ í†µí•´ ì—ë„ˆì§€ë¥¼ ì–»ìŠµë‹ˆë‹¤.' },
            'N': { name: 'ì§ê´€í˜• (Intuitive)', desc: 'ë¯¸ë˜ ì§€í–¥ì ì´ê³  ìƒìƒë ¥ì´ í’ë¶€í•˜ë©°, ê°€ëŠ¥ì„±ê³¼ ì˜ë¯¸ë¥¼ ì¤‘ì‹œí•©ë‹ˆë‹¤.' },
            'S': { name: 'ê°ê°í˜• (Sensing)', desc: 'í˜„ì‹¤ì ì´ê³  ì‹¤ìš©ì ì´ë©°, êµ¬ì²´ì ì¸ ì‚¬ì‹¤ê³¼ ê²½í—˜ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.' },
            'T': { name: 'ì‚¬ê³ í˜• (Thinking)', desc: 'ë…¼ë¦¬ì ì´ê³  ë¶„ì„ì ì´ë©°, ê°ê´€ì ì¸ ê¸°ì¤€ìœ¼ë¡œ íŒë‹¨í•©ë‹ˆë‹¤.' },
            'F': { name: 'ê°ì •í˜• (Feeling)', desc: 'ê°ì •ì ì´ê³  ê³µê°ì ì´ë©°, ì¸ê°„ê´€ê³„ì™€ ê°€ì¹˜ë¥¼ ì¤‘ì‹œí•©ë‹ˆë‹¤.' },
            'J': { name: 'íŒë‹¨í˜• (Judging)', desc: 'ê³„íšì ì´ê³  ì²´ê³„ì ì´ë©°, ì •ë¦¬ëœ í™˜ê²½ì„ ì„ í˜¸í•©ë‹ˆë‹¤.' },
            'P': { name: 'ì¸ì‹í˜• (Perceiving)', desc: 'ìœ ì—°í•˜ê³  ì¦‰í¥ì ì´ë©°, ê°œë°©ì ì¸ íƒœë„ë¥¼ ê°€ì§‘ë‹ˆë‹¤.' }
        };

        class MBTITest {
            constructor() {
                this.answers = {};
                this.currentView = 'intro';
                this.currentQuestion = 1;
                this.userName = '';
                this.render();
            }

            selectOption(questionNum, choice) {
                if (choice === 'A') {
                    this.answers[questionNum] = { a: 5, b: 0, choice: 'A' };
                } else {
                    this.answers[questionNum] = { a: 0, b: 5, choice: 'B' };
                }
                this.render();
            }

            startTest() {
                const nameInput = document.getElementById('userName');
                if (nameInput) {
                    this.userName = nameInput.value.trim();
                }
                
                if (!this.userName) {
                    alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                    return;
                }
                
                this.currentView = 'test';
                this.currentQuestion = 1;
                this.render();
            }

            nextQuestion() {
                if (this.currentQuestion < 32) {
                    this.currentQuestion++;
                    this.render();
                    window.scrollTo(0, 0);
                }
            }

            prevQuestion() {
                if (this.currentQuestion > 1) {
                    this.currentQuestion--;
                    this.render();
                    window.scrollTo(0, 0);
                }
            }

            calculateResults() {
                const scores = { I: 0, E: 0, N: 0, S: 0, T: 0, F: 0, J: 0, P: 0 };

                for (let i = 1; i <= 32; i++) {
                    const answer = this.answers[i];
                    if (answer) {
                        const mapping = categoryMapping[i];
                        scores[mapping.a] += answer.a;
                        scores[mapping.b] += answer.b;
                    }
                }

                const result = {
                    dim1: scores.E >= scores.I ? 'E' : 'I',
                    dim2: scores.N >= scores.S ? 'N' : 'S',
                    dim3: scores.T >= scores.F ? 'T' : 'F',
                    dim4: scores.J >= scores.P ? 'J' : 'P',
                    scores: scores,
                    mbti: ''
                };

                result.mbti = result.dim1 + result.dim2 + result.dim3 + result.dim4;

                result.balances = {
                    IE: Math.abs(scores.I - scores.E),
                    NS: Math.abs(scores.N - scores.S),
                    TF: Math.abs(scores.T - scores.F),
                    JP: Math.abs(scores.J - scores.P)
                };

                return result;
            }

            getBalanceText(diff) {
                if (diff >= 0 && diff <= 1) return { text: 'ì–‘ìª½ ê°œì„±ì´ ê· í˜•ì„ ìœ ì§€', class: '' };
                if (diff >= 2 && diff <= 4) return { text: 'í•œìª½ ê°œì„±ì´ ë‹¤ì†Œ ê°•í•˜ë‹¤', class: '' };
                if (diff >= 5 && diff <= 9) return { text: 'í•œìª½ ê°œì„±ì´ ë§¤ìš° ê°•í•˜ë‹¤', class: 'strong' };
                return { text: 'í•œìª½ ê°œì„±ì´ ë„ˆë¬´ ê°•í•˜ë‹¤', class: 'very-strong' };
            }

            showResults() {
                this.currentView = 'result';
                this.render();
                window.scrollTo(0, 0);
            }

            restart() {
                this.answers = {};
                this.currentView = 'intro';
                this.currentQuestion = 1;
                this.userName = '';
                this.render();
                window.scrollTo(0, 0);
            }

            renderIntro() {
                return `
                    <div class="intro">
                        <h2>ğŸ“‹ ê²€ì‚¬ ì•ˆë‚´</h2>
                        <ul>
                            <li><strong>ì´ 32ê°œì˜ ì§ˆë¬¸</strong>ì´ ìˆìŠµë‹ˆë‹¤</li>
                            <li>ê° ì§ˆë¬¸ë§ˆë‹¤ ë‘ ê°€ì§€ ì„ íƒì§€(A, B)ê°€ ìˆìŠµë‹ˆë‹¤</li>
                            <li><strong>ë” ë‚˜ì™€ ê°€ê¹Œìš´ ì„ íƒì§€</strong>ë¥¼ ì„ íƒí•˜ì„¸ìš”</li>
                            <li>í•œ í˜ì´ì§€ì— í•œ ì§ˆë¬¸ì”© ë‚˜ì˜µë‹ˆë‹¤</li>
                            <li>ì†”ì§í•˜ê²Œ ë‹µë³€í• ìˆ˜ë¡ ì •í™•í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                        </ul>
                    </div>
                    <div class="content">
                        <div class="name-input-section">
                            <h3>ğŸ‘¤ ê²€ì‚¬ì ì •ë³´</h3>
                            <div class="input-group">
                                <label for="userName">ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</label>
                                <input 
                                    type="text" 
                                    id="userName" 
                                    placeholder="í™ê¸¸ë™"
                                    value="${this.userName}"
                                    onkeypress="if(event.key === 'Enter') app.startTest()"
                                >
                            </div>
                        </div>
                        <div class="button-container">
                            <button class="btn" onclick="app.startTest()">ê²€ì‚¬ ì‹œì‘í•˜ê¸°</button>
                        </div>
                    </div>
                `;
            }

            renderTest() {
                const q = questions[this.currentQuestion - 1];
                const answer = this.answers[this.currentQuestion] || null;
                const progress = (Object.keys(this.answers).length / 32) * 100;

                let html = `
                    <div class="content">
                        <div class="progress-text">${this.currentQuestion} / 32</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>

                        <div class="question-card">
                            <span class="question-number">ì§ˆë¬¸ ${q.q}</span>
                            
                            <div class="option ${answer && answer.choice === 'A' ? 'selected' : ''}" 
                                 onclick="app.selectOption(${this.currentQuestion}, 'A')">
                                <div class="option-header">
                                    <div class="option-label">A</div>
                                    <div class="option-text">${q.a}</div>
                                    <div class="check-icon">âœ“</div>
                                </div>
                            </div>

                            <div class="option ${answer && answer.choice === 'B' ? 'selected' : ''}" 
                                 onclick="app.selectOption(${this.currentQuestion}, 'B')">
                                <div class="option-header">
                                    <div class="option-label">B</div>
                                    <div class="option-text">${q.b}</div>
                                    <div class="check-icon">âœ“</div>
                                </div>
                            </div>
                        </div>

                        <div class="navigation-buttons">
                            ${this.currentQuestion > 1 ? 
                                '<button class="btn btn-secondary" onclick="app.prevQuestion()">â† ì´ì „</button>' : 
                                '<button class="btn btn-secondary" disabled>â† ì´ì „</button>'
                            }
                            
                            ${this.currentQuestion < 32 ? 
                                `<button class="btn" ${!answer ? 'disabled' : ''} onclick="app.nextQuestion()">ë‹¤ìŒ â†’</button>` :
                                `<button class="btn" ${Object.keys(this.answers).length < 32 ? 'disabled' : ''} onclick="app.showResults()">
                                    ${Object.keys(this.answers).length < 32 ? 'ëª¨ë“  ì§ˆë¬¸ì— ë‹µí•´ì£¼ì„¸ìš”' : 'ê²°ê³¼ ë³´ê¸°'}
                                </button>`
                            }
                        </div>
                    </div>
                `;

                return html;
            }

            renderResult() {
                const result = this.calculateResults();
                const currentDate = new Date().toLocaleDateString('ko-KR');
                
                let html = `
                    <div class="result">
                        <div class="user-name-display">
                            <strong>${this.userName}</strong>ë‹˜ì˜ ê²€ì‚¬ ê²°ê³¼
                        </div>
                        
                        <h2>ğŸ‰ MBTI ìœ í˜•</h2>
                        <div class="mbti-result">${result.mbti}</div>
                        
                        <div class="description-box">
                            <h3>ë‹¹ì‹ ì˜ MBTI ìœ í˜•</h3>
                `;

                [result.dim1, result.dim2, result.dim3, result.dim4].forEach(type => {
                    const info = mbtiDescriptions[type];
                    html += `<p><strong>${info.name}:</strong> ${info.desc}</p>`;
                });

                html += `
                            <p style="margin-top: 15px; color: #6c757d; font-size: 0.9em;">
                                ê²€ì‚¬ì¼: ${currentDate}
                            </p>
                        </div>`;

                html += `
                    <div class="category-results">
                        <div class="category-card">
                            <h3>ì™¸í–¥ / ë‚´í–¥</h3>
                            <div class="category-score">${result.dim1}</div>
                            <p>E: ${result.scores.E}ì  | I: ${result.scores.I}ì </p>
                            <div class="balance-info ${this.getBalanceText(result.balances.IE).class}">
                                ${this.getBalanceText(result.balances.IE).text}
                            </div>
                        </div>
                        <div class="category-card">
                            <h3>ê°ê° / ì§ê´€</h3>
                            <div class="category-score">${result.dim2}</div>
                            <p>S: ${result.scores.S}ì  | N: ${result.scores.N}ì </p>
                            <div class="balance-info ${this.getBalanceText(result.balances.NS).class}">
                                ${this.getBalanceText(result.balances.NS).text}
                            </div>
                        </div>
                        <div class="category-card">
                            <h3>ì‚¬ê³  / ê°ì •</h3>
                            <div class="category-score">${result.dim3}</div>
                            <p>T: ${result.scores.T}ì  | F: ${result.scores.F}ì </p>
                            <div class="balance-info ${this.getBalanceText(result.balances.TF).class}">
                                ${this.getBalanceText(result.balances.TF).text}
                            </div>
                        </div>
                        <div class="category-card">
                            <h3>íŒë‹¨ / ì¸ì‹</h3>
                            <div class="category-score">${result.dim4}</div>
                            <p>J: ${result.scores.J}ì  | P: ${result.scores.P}ì </p>
                            <div class="balance-info ${this.getBalanceText(result.balances.JP).class}">
                                ${this.getBalanceText(result.balances.JP).text}
                            </div>
                        </div>
                    </div>

                    <div class="submit-info">
                        <h4>ğŸ“Š ê²°ê³¼ ì œì¶œí•˜ê¸°</h4>
                        <p>ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²€ì‚¬ ê²°ê³¼ë¥¼ êµ¬ê¸€ ì‹œíŠ¸ì— ìë™ìœ¼ë¡œ ì œì¶œí•´ì£¼ì„¸ìš”</p>
                        ${localStorage.getItem('submitted_' + this.userName + '_' + result.mbti) ? 
                            '<p style="color: #28a745; font-weight: bold;">âœ… ì´ë¯¸ ì œì¶œ ì™„ë£Œ</p>' : ''}
                    </div>

                    <div class="button-container" style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                        <button class="btn" onclick="app.submitToGoogleSheet()" id="submitBtn">
                            ğŸ“Š êµ¬ê¸€ ì‹œíŠ¸ì— ì œì¶œ
                        </button>
                        <button class="btn" onclick="app.copyResult()">ğŸ“‹ ê²°ê³¼ ë³µì‚¬</button>
                        <button class="btn" onclick="app.saveResult()">ğŸ’¾ íŒŒì¼ë¡œ ì €ì¥</button>
                    </div>
                    
                    <div class="button-container" style="margin-top: 10px;">
                        <button class="btn btn-secondary" onclick="app.restart()">ë‹¤ì‹œ ê²€ì‚¬í•˜ê¸°</button>
                    </div>
                </div>
                `;

                return html;
            }

            getResultText() {
                const result = this.calculateResults();
                const currentDate = new Date().toLocaleDateString('ko-KR');
                
                return `ì´ë¦„: ${this.userName}
ê²€ì‚¬ì¼: ${currentDate}
MBTI: ${result.mbti}

[ì„¸ë¶€ ì ìˆ˜]
ì™¸í–¥(E): ${result.scores.E}ì  / ë‚´í–¥(I): ${result.scores.I}ì 
ì§ê´€(N): ${result.scores.N}ì  / ê°ê°(S): ${result.scores.S}ì 
ì‚¬ê³ (T): ${result.scores.T}ì  / ê°ì •(F): ${result.scores.F}ì 
íŒë‹¨(J): ${result.scores.J}ì  / ì¸ì‹(P): ${result.scores.P}ì `;
            }

            async submitToGoogleSheet() {
                if (!GOOGLE_SHEET_URL || GOOGLE_SHEET_URL === "YOUR_GOOGLE_APPS_SCRIPT_URL_HERE") {
                    alert('âš ï¸ ê´€ë¦¬ìê°€ ì•„ì§ êµ¬ê¸€ ì‹œíŠ¸ë¥¼ ì„¤ì •í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\nê²°ê³¼ë¥¼ ë³µì‚¬í•˜ê±°ë‚˜ íŒŒì¼ë¡œ ì €ì¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                const submitBtn = document.getElementById('submitBtn');
                const originalText = submitBtn.innerHTML;
                submitBtn.innerHTML = 'â³ ì œì¶œ ì¤‘...';
                submitBtn.disabled = true;

                const result = this.calculateResults();
                const currentDate = new Date().toISOString();
                
                // í¼ì„ ë§Œë“¤ì–´ì„œ ì œì¶œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½ (CORS ë¬¸ì œ í•´ê²°)
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = GOOGLE_SHEET_URL;
                form.target = 'hidden_iframe';
                
                const data = {
                    timestamp: currentDate,
                    name: this.userName,
                    mbti: result.mbti,
                    E: result.scores.E,
                    I: result.scores.I,
                    N: result.scores.N,
                    S: result.scores.S,
                    T: result.scores.T,
                    F: result.scores.F,
                    J: result.scores.J,
                    P: result.scores.P,
                    dim1: result.dim1,
                    dim2: result.dim2,
                    dim3: result.dim3,
                    dim4: result.dim4
                };

                // ë°ì´í„°ë¥¼ JSON ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ì—¬ hidden inputìœ¼ë¡œ ì¶”ê°€
                for (let key in data) {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = data[key];
                    form.appendChild(input);
                }

                // hidden iframe ìƒì„± (ì´ë¯¸ ìˆìœ¼ë©´ ì‚¬ìš©)
                let iframe = document.getElementById('hidden_iframe');
                if (!iframe) {
                    iframe = document.createElement('iframe');
                    iframe.id = 'hidden_iframe';
                    iframe.name = 'hidden_iframe';
                    iframe.style.display = 'none';
                    document.body.appendChild(iframe);
                }

                // í¼ ì œì¶œ
                document.body.appendChild(form);
                form.submit();
                document.body.removeChild(form);

                // 2ì´ˆ í›„ ì„±ê³µ ë©”ì‹œì§€ (í¼ ì œì¶œì€ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ íƒ€ì´ë¨¸ ì‚¬ìš©)
                setTimeout(() => {
                    localStorage.setItem('submitted_' + this.userName + '_' + result.mbti, 'true');
                    alert('âœ… ê²€ì‚¬ ê²°ê³¼ê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!');
                    this.render();
                }, 2000);
            }

            copyResult() {
                const resultText = this.getResultText();
                
                navigator.clipboard.writeText(resultText).then(() => {
                    alert('âœ… ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ì œ ì´ë©”ì¼ì´ë‚˜ ë©”ì‹œì§€ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
                }).catch(err => {
                    // ë³µì‚¬ ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ë°©ë²•
                    const textarea = document.createElement('textarea');
                    textarea.value = resultText;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    alert('âœ… ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                });
            }

            saveResult() {
                const result = this.calculateResults();
                const currentDate = new Date().toLocaleDateString('ko-KR');
                
                const resultText = `
===========================================
      MBTI ê²€ì‚¬ ê²°ê³¼
===========================================

ì´ë¦„: ${this.userName}
ê²€ì‚¬ì¼: ${currentDate}
MBTI ìœ í˜•: ${result.mbti}

-------------------------------------------
ì„¸ë¶€ ì ìˆ˜
-------------------------------------------
ì™¸í–¥(E) ${result.scores.E}ì  / ë‚´í–¥(I) ${result.scores.I}ì  â†’ ${result.dim1}
ì§ê´€(N) ${result.scores.N}ì  / ê°ê°(S) ${result.scores.S}ì  â†’ ${result.dim2}
ì‚¬ê³ (T) ${result.scores.T}ì  / ê°ì •(F) ${result.scores.F}ì  â†’ ${result.dim3}
íŒë‹¨(J) ${result.scores.J}ì  / ì¸ì‹(P) ${result.scores.P}ì  â†’ ${result.dim4}

-------------------------------------------
ìœ í˜• ì„¤ëª…
-------------------------------------------
${result.dim1}: ${mbtiDescriptions[result.dim1].name}
${mbtiDescriptions[result.dim1].desc}

${result.dim2}: ${mbtiDescriptions[result.dim2].name}
${mbtiDescriptions[result.dim2].desc}

${result.dim3}: ${mbtiDescriptions[result.dim3].name}
${mbtiDescriptions[result.dim3].desc}

${result.dim4}: ${mbtiDescriptions[result.dim4].name}
${mbtiDescriptions[result.dim4].desc}

-------------------------------------------
ê· í˜•ì„± ë¶„ì„
-------------------------------------------
ì™¸í–¥/ë‚´í–¥: ${this.getBalanceText(result.balances.IE).text}
ê°ê°/ì§ê´€: ${this.getBalanceText(result.balances.NS).text}
ì‚¬ê³ /ê°ì •: ${this.getBalanceText(result.balances.TF).text}
íŒë‹¨/ì¸ì‹: ${this.getBalanceText(result.balances.JP).text}

===========================================
                `.trim();

                const blob = new Blob([resultText], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${this.userName}_MBTI_${result.mbti}_${currentDate.replace(/\. /g, '-').replace('.', '')}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            render() {
                const appDiv = document.getElementById('app');
                
                switch(this.currentView) {
                    case 'intro':
                        appDiv.innerHTML = this.renderIntro();
                        break;
                    case 'test':
                        appDiv.innerHTML = this.renderTest();
                        break;
                    case 'result':
                        appDiv.innerHTML = this.renderResult();
                        break;
                }
            }
        }

        const app = new MBTITest();
    </script>
</body>
</html>
